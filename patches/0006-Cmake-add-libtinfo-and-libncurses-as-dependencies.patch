From d0a8a1e97be14caa42abb33cf6f23805cadae086 Mon Sep 17 00:00:00 2001
From: Umberto Baldi <u.baldi@arduino.cc>
Date: Tue, 3 May 2022 17:00:18 +0200
Subject: [PATCH] CMake add libtinfo and libncurses as dependencies

Co-authored-by: Martino Facchin <m.facchin@arduino.cc>
---
 CMakeLists.txt     | 10 ++++++++++
 src/CMakeLists.txt |  2 ++
 2 files changed, 12 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 522f505..6b7af1f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -227,6 +227,16 @@ elseif(MSVC)
     set(HAVE_LIBREADLINE 1)
 endif()

+find_library(HAVE_LIBNCURSES NAMES ncurses)
+if(HAVE_LIBNCURSES)
+    set(LIB_LIBNCURSES ${HAVE_LIBNCURSES})
+endif()
+
+find_library(HAVE_LIBTINFO NAMES tinfo)
+if(HAVE_LIBTINFO)
+    set(LIB_LIBTINFO ${HAVE_LIBTINFO})
+endif()
+
 # =====================================
 # Use external libraries if requested
 # =====================================
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index c51214e..e3abc2d 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -271,6 +271,8 @@ target_link_libraries(libavrdude
     ${LIB_LIBFTDI}
     ${LIB_LIBFTDI1}
     ${LIB_LIBREADLINE}
+    ${LIB_LIBNCURSES}
+    ${LIB_LIBTINFO}
     ${EXTRA_WINDOWS_LIBRARIES}
     )
 
-- 
2.17.1

